<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClientFlow • Riskbedömning av byråns tjänster</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Merriweather+Sans:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar-container">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2><i class="fas fa-chart-line"></i> ClientFlow</h2>
                    <p>Kundhantering & Riskbedömning</p>
                </div>
                
                <nav class="sidebar-nav">
                    <div class="nav-section">
                        <h3><i class="fas fa-shield-alt"></i> Verktyg för riskbedömning</h3>
                        <ul>
                            <li data-page="riskbedomning-byra" class="active">
                                <a href="riskbedomning-byra.html">
                                    <i class="fas fa-building"></i>
                                    <span>Riskbedömning av byrå</span>
                                </a>
                            </li>
                            <li data-page="ovriga-riskfaktorer">
                                <a href="ovriga-riskfaktorer.html">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <span>Övriga riskfaktorer</span>
                                </a>
                            </li>
                            <li data-page="allman-riskbedomning">
                                <a href="allman-riskbedomning.html">
                                    <i class="fas fa-clipboard-check"></i>
                                    <span>Allmän riskbedömning</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="nav-section">
                        <h3><i class="fas fa-file-alt"></i> Dokument</h3>
                        <ul>
                            <li data-page="statistik-riskbedomning">
                                <a href="statistik-riskbedomning.html">
                                    <i class="fas fa-chart-bar"></i>
                                    <span>Statistik för riskbedömning</span>
                                </a>
                            </li>
                            <li data-page="byra-anvandare">
                                <a href="byra-anvandare.html">
                                    <i class="fas fa-users"></i>
                                    <span>Uppgifter byrå & användare</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="nav-section">
                        <h3><i class="fas fa-cogs"></i> Hantering</h3>
                        <ul>
                            <li data-page="index" class="nav-item-lead">
                                <a href="index.html">
                                    <i class="fas fa-plus-circle"></i>
                                    <span>Nytt Lead</span>
                                </a>
                            </li>
                            <li data-page="kundkort" class="nav-item-klienter">
                                <a href="kundkort.html">
                                    <i class="fas fa-address-book"></i>
                                    <span>Alla Klienter</span>
                                </a>
                            </li>
                            <li data-page="avvikelser">
                                <a href="avvikelser.html">
                                    <i class="fas fa-exclamation-circle"></i>
                                    <span>Avvikelser</span>
                                </a>
                            </li>
                            <li data-page="registrera-utbildning">
                                <a href="registrera-utbildning.html">
                                    <i class="fas fa-graduation-cap"></i>
                                    <span>Registrera utbildning</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </aside>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1>Riskbedömning av byråns tjänster</h1>
                <p>Hantera och bedöm risker kopplade till olika tjänster som byrån utför</p>
            </header>

            <!-- Filter Section -->
            <section class="filter-section">
                <div class="filter-card">
                    <div class="filter-header">
                        <h3><i class="fas fa-filter"></i> Filtrera riskbedömningar</h3>
                    </div>
                    <div class="filter-controls">
                        <div class="filter-group">
                            <label for="byra-filter">Byrå:</label>
                            <select id="byra-filter" class="form-select">
                                <option value="">Alla byråer</option>
                                <option value="31">Byrå 31</option>
                                <option value="32">Byrå 32</option>
                                <option value="33">Byrå 33</option>
                                <option value="39">Byrå 39</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="tjänsttyp-filter">Tjänsttyp:</label>
                            <select id="tjänsttyp-filter" class="form-select">
                                <option value="">Alla tjänsttyper</option>
                                <option value="AVSTÄMNING">Avstämning</option>
                                <option value="BOKSLUT">Bokslut</option>
                                <option value="DEKLARATION">Deklaration</option>
                                <option value="KUNDRESKONTRA">Kundreskontra</option>
                                <option value="LÖNEHANTERING">Lönehantering</option>
                                <option value="LEVERANTÖRSRESKONTRA">Leverantörsreskontra</option>
                                <option value="LÖPANDE BOKFÖRING">Löpande bokföring</option>
                                <option value="MOMS">Moms</option>
                                <option value="ÅRSREDOVISNING">Årsredovisning</option>
                                <option value="RÅDGIVNING">Rådgivning</option>
                                <option value="UPPRÄTTA KONTROLLBALANSRÄKNING">Kontrollbalansräkning</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="risk-filter">Risknivå:</label>
                            <select id="risk-filter" class="form-select">
                                <option value="">Alla risknivåer</option>
                                <option value="Låg">Låg</option>
                                <option value="Medel">Medel</option>
                                <option value="Hög">Hög</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="status-filter">Status:</label>
                            <select id="status-filter" class="form-select">
                                <option value="">Alla statusar</option>
                                <option value="checked">Aktuell</option>
                                <option value="unchecked">Ej aktuell</option>
                            </select>
                        </div>
                        <button id="apply-filters" class="btn btn-primary">
                            <i class="fas fa-search"></i>
                            Applicera filter
                        </button>
                        <button id="clear-filters" class="btn btn-secondary">
                            <i class="fas fa-times"></i>
                            Rensa filter
                        </button>
                    </div>
                </div>
            </section>

            <!-- Risk Assessment List -->
            <section class="risk-assessment-section">
                <div class="risk-list-header">
                    <h3>Riskbedömningar</h3>
                    <div class="risk-header-actions">
                        <div class="risk-stats">
                            <span class="stat-item">
                                <i class="fas fa-list"></i>
                                <span id="total-count">0</span> totalt
                            </span>
                            <span class="stat-item">
                                <i class="fas fa-exclamation-triangle text-warning"></i>
                                <span id="high-risk-count">0</span> höga risker
                            </span>
                            <span class="stat-item">
                                <i class="fas fa-check-circle text-success"></i>
                                <span id="completed-count">0</span> godkända
                            </span>
                        </div>
                        <button class="btn btn-primary" onclick="riskManager.openAddModal()">
                            <i class="fas fa-plus"></i>
                            Lägg till riskbedömning
                        </button>
                    </div>
                </div>

                <div id="risk-list" class="risk-list">
                    <!-- Risk items will be loaded here -->
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Laddar riskbedömningar...</p>
                    </div>
                </div>
            </section>

            <!-- Add New Risk Modal -->
            <div id="add-risk-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Lägg till ny riskbedömning</h3>
                        <button class="modal-close" onclick="closeModal('add-risk-modal')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="add-risk-form" class="modal-form">
                        <div class="form-group">
                            <label for="task-name">Uppgiftsnamn *</label>
                            <input type="text" id="task-name" name="task-name" required>
                        </div>
                        <div class="form-group">
                            <label for="byra-id">Byrå ID</label>
                            <input type="text" id="byra-id" name="byra-id">
                        </div>
                        <div class="form-group">
                            <label for="tjansttyp">Tjänsttyp *</label>
                            <select id="tjansttyp" name="tjansttyp" required>
                                <option value="">Välj tjänsttyp</option>
                                <option value="AVSTÄMNING">Avstämning</option>
                                <option value="BOKSLUT">Bokslut</option>
                                <option value="DEKLARATION">Deklaration</option>
                                <option value="KUNDRESKONTRA">Kundreskontra</option>
                                <option value="LÖNEHANTERING">Lönehantering</option>
                                <option value="LEVERANTÖRSRESKONTRA">Leverantörsreskontra</option>
                                <option value="LÖPANDE BOKFÖRING">Löpande bokföring</option>
                                <option value="MOMS">Moms</option>
                                <option value="ÅRSREDOVISNING">Årsredovisning</option>
                                <option value="RÅDGIVNING">Rådgivning</option>
                                <option value="UPPRÄTTA KONTROLLBALANSRÄKNING">Kontrollbalansräkning</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="risk-description">Beskrivning av riskfaktor *</label>
                            <textarea id="risk-description" name="risk-description" rows="4" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="risk-level">Riskbedömning *</label>
                            <select id="risk-level" name="risk-level" required>
                                <option value="">Välj risknivå</option>
                                <option value="Låg">Låg</option>
                                <option value="Medel">Medel</option>
                                <option value="Hög">Hög</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="action">Åtgärd *</label>
                            <textarea id="action" name="action" rows="4" required></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="closeModal('add-risk-modal')">
                                Avbryt
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                Spara riskbedömning
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Edit Risk Modal -->
            <div id="edit-risk-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Redigera riskbedömning</h3>
                        <button class="modal-close" onclick="closeModal('edit-risk-modal')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="edit-risk-form" class="modal-form">
                        <input type="hidden" id="edit-record-id" name="record-id">
                        <div class="form-group">
                            <label for="edit-task-name">Uppgiftsnamn *</label>
                            <input type="text" id="edit-task-name" name="task-name" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-byra-id">Byrå ID</label>
                            <input type="text" id="edit-byra-id" name="byra-id">
                        </div>
                        <div class="form-group">
                            <label for="edit-tjansttyp">Tjänsttyp *</label>
                            <select id="edit-tjansttyp" name="tjansttyp" required>
                                <option value="">Välj tjänsttyp</option>
                                <option value="AVSTÄMNING">Avstämning</option>
                                <option value="BOKSLUT">Bokslut</option>
                                <option value="DEKLARATION">Deklaration</option>
                                <option value="KUNDRESKONTRA">Kundreskontra</option>
                                <option value="LÖNEHANTERING">Lönehantering</option>
                                <option value="LEVERANTÖRSRESKONTRA">Leverantörsreskontra</option>
                                <option value="LÖPANDE BOKFÖRING">Löpande bokföring</option>
                                <option value="MOMS">Moms</option>
                                <option value="ÅRSREDOVISNING">Årsredovisning</option>
                                <option value="RÅDGIVNING">Rådgivning</option>
                                <option value="UPPRÄTTA KONTROLLBALANSRÄKNING">Kontrollbalansräkning</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-risk-description">Beskrivning av riskfaktor *</label>
                            <textarea id="edit-risk-description" name="risk-description" rows="4" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="edit-risk-level">Riskbedömning *</label>
                            <select id="edit-risk-level" name="risk-level" required>
                                <option value="">Välj risknivå</option>
                                <option value="Låg">Låg</option>
                                <option value="Medel">Medel</option>
                                <option value="Hög">Hög</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-action">Åtgärd *</label>
                            <textarea id="edit-action" name="action" rows="4" required></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="closeModal('edit-risk-modal')">
                                Avbryt
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                Uppdatera riskbedömning
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2024 ClientFlow. Alla rättigheter förbehållna.</p>
        </div>
    </footer>

    <!-- Load scripts -->
    <script src="js/navigation.js"></script>
    <script src="js/riskbedomning-byra.js"></script>
</body>
</html>
